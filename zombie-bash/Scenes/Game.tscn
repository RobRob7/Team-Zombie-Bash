[gd_scene load_steps=11 format=3 uid="uid://c3pet4v6sysex"]

[ext_resource type="PackedScene" uid="uid://bm3myde0k8xtl" path="res://Scenes/LaneSystem3D.tscn" id="2_0a4qs"]
[ext_resource type="Texture2D" uid="uid://dahmjrsd54spb" path="res://Sprites/game/arrow_button/left/arrow_button_left1.png" id="2_pf1s4"]
[ext_resource type="Texture2D" uid="uid://bo2oi7rw1wmlg" path="res://Sprites/game/arrow_button/up/arrow_button_up1.png" id="3_h8k8t"]
[ext_resource type="Texture2D" uid="uid://ok3snj1r0oci" path="res://Sprites/game/arrow_button/right/arrow_button_right1.png" id="4_w3nx6"]
[ext_resource type="Script" path="res://Scripts/Game.gd" id="6"]
[ext_resource type="FontFile" path="res://Fonts/heartbit2x.tres" id="7"]
[ext_resource type="PackedScene" uid="uid://bkuto0ehjooso" path="res://Scenes/Conductor.tscn" id="8"]

[sub_resource type="PlaneMesh" id="PlaneMesh_3hnmu"]
size = Vector2(0.5, 3)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_gl6kp"]
emission_enabled = true
emission = Color(0.258824, 0.866667, 0.403922, 1)
emission_energy_multiplier = 1.5

[sub_resource type="GDScript" id="GDScript_eic0v"]
script/source = "extends Node3D

# References to the arrows
@onready var left_arrow = $LeftArrow
@onready var up_arrow = $UpArrow
@onready var right_arrow = $RightArrow

# Highlights an arrow by changing its modulate color
func _highlight_arrow(arrow: Node3D, color: Color):
	if arrow is Sprite3D:
		arrow.modulate = color  # Change the color dynamically

# Reset the arrow's color
func _reset_arrow(arrow: Node3D):
	if arrow is Sprite3D:
		arrow.modulate = Color(1, 1, 1)  # Reset to white

# Flashes the arrow color briefly
func _flash_arrow(arrow: Node3D, color: Color, duration: float = 0.2) -> void:
	_highlight_arrow(arrow, color)
	await get_tree().create_timer(duration).timeout  # Await the timer timeout
	_reset_arrow(arrow)

# Triggered when a note enters a specific lane
func _on_note_entered_lane(lane: String) -> void:
	match lane:
		\"left\":
			_highlight_arrow(left_arrow, Color(0, 1, 0))  # Green for \"Perfect\"
		\"up\":
			_highlight_arrow(up_arrow, Color(0, 1, 0))  # Green for \"Perfect\"
		\"right\":
			_highlight_arrow(right_arrow, Color(0, 1, 0))  # Green for \"Perfect\"

# Triggered when a note leaves a specific lane
func _on_note_exited_lane(lane: String) -> void:
	match lane:
		\"left\":
			_reset_arrow(left_arrow)
		\"up\":
			_reset_arrow(up_arrow)
		\"right\":
			_reset_arrow(right_arrow)

# Triggered when a note is hit
func _on_note_hit(lane: String) -> void:
	match lane:
		\"left\":
			await _flash_arrow(left_arrow, Color(1, 1, 0))  # Yellow flash for hit
		\"up\":
			await _flash_arrow(up_arrow, Color(1, 1, 0))  # Yellow flash for hit
		\"right\":
			await _flash_arrow(right_arrow, Color(1, 1, 0))  # Yellow flash for hit
"

[node name="Game" type="Node"]
script = ExtResource("6")

[node name="HitIndicator" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.05537, 0.587841, -0.0979296)
mesh = SubResource("PlaneMesh_3hnmu")
surface_material_override/0 = SubResource("StandardMaterial3D_gl6kp")
script = SubResource("GDScript_eic0v")

[node name="UpArrow" type="Sprite3D" parent="HitIndicator"]
transform = Transform3D(0.153936, 0.98755, 0.0323945, 0.047793, 0.0253051, -0.998537, -0.986924, 0.155259, -0.0433026, -0.110988, 0.196535, 0.118862)
texture = ExtResource("3_h8k8t")

[node name="LeftArrow" type="Sprite3D" parent="HitIndicator"]
transform = Transform3D(0.0540788, -0.997075, -0.0539997, 0, 0.0540788, -0.998537, 0.998537, 0.0539997, 0.00292452, -0.145702, 0.243778, -0.839711)
texture = ExtResource("2_pf1s4")

[node name="RightArrow" type="Sprite3D" parent="HitIndicator"]
transform = Transform3D(-0.161604, -0.950964, -0.263726, -2.33627e-08, 0.267238, -0.96363, 0.986856, -0.155726, -0.0431867, 0.0168376, 0.108049, 0.983135)
texture = ExtResource("4_w3nx6")

[node name="LaneSystem3D" parent="." instance=ExtResource("2_0a4qs")]

[node name="Label" type="Label" parent="."]
visible = false
offset_left = 4.0
offset_top = 4.0
offset_right = 44.0
offset_bottom = 18.0
theme_override_colors/font_color = Color(0.964706, 0, 0, 1)
theme_override_fonts/font = ExtResource("7")
text = "0"

[node name="Conductor" parent="." instance=ExtResource("8")]
volume_db = -15.0
